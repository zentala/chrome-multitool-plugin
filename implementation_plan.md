# Implementation Plan

## Overview
The project is a comprehensive Chrome extension called "Zentala Chrome Multitool Plugin" that currently includes bookmark management, Allegro favourites tracking, and a currency converter. The user wants to expand this plugin with several major enhancements:

1. **Git Merge Resolution**: Resolve conflicts between local and remote branches. Commit current changes. 
2. **Currency Converter Enhancement**: Improve the existing currency converter with context menu integration and better UI
3. **YouTube Plugin Integration**: Integrate the separate YouTube extension into the main plugin
4. **Popup Restructuring**: Redesign the popup to show multiple modules with settings buttons
5. **Settings System**: Add comprehensive settings pages for each module

## Types

### Existing Interfaces
- `ConversionResult`: Handles currency conversion responses
- `CurrencyParseResult`: Manages AI parsing of currency text
- `AI` interfaces: Handle AI provider abstractions

### New Interfaces Required
```typescript
interface ModuleSettings {
  id: string;
  name: string;
  icon: string;
  enabled: boolean;
  settings: Record<string, any>;
}

interface PopupModule {
  id: string;
  name: string;
  icon: string;
  component: React.ComponentType;
  settingsComponent: React.ComponentType;
  isActive: boolean;
}

interface YouTubeCaptionData {
  videoId: string;
  language: string;
  captions: string;
  autoGenerated: boolean;
}

interface AISettings {
  provider: 'openai' | 'claude' | 'gemini', 'grok';
  apiKey: string;
  model: string;
  temperature: number;
}
```

## Files

### New Files to Create
- `src/components/Popup/ModuleList.tsx` - Main popup component with module list
- `src/components/Popup/ModuleCard.tsx` - Individual module card component
- `src/components/Settings/SettingsPage.tsx` - Generic settings page component
- `src/components/YouTube/YouTubeModule.tsx` - YouTube transcription module
- `src/components/YouTube/YouTubeSettings.tsx` - YouTube module settings
- `src/services/youtube.service.ts` - YouTube API integration service
- `src/services/transcription.service.ts` - Handle transcription processing
- `src/background/features/youtube/` - Background scripts for YouTube features
- `src/content/youtube-content.ts` - Content script for YouTube pages
- `src/injectors/youtube-injector.ts` - YouTube page injector
- `public/youtube-settings.html` - YouTube settings page
- `src/components/CurrencyConverter/CurrencyContextMenu.tsx` - Enhanced context menu component

### Existing Files to Modify
- `src/components/Popup/App.tsx` - Replace with new module-based structure
- `src/components/CurrencyConverter/CurrencyConverter.tsx` - Add context menu integration
- `src/background/listeners.ts` - Add YouTube listeners and enhance currency menu
- `public/manifest.json` - Add YouTube permissions and content scripts
- `src/popup.tsx` - Update to use new popup structure

### Files to Delete
- `chrome-zentala-yt/` - Entire separate YouTube plugin directory (will be integrated)

## Functions

### New Functions to Create
- `initializeYouTubeModule()` in `src/background/listeners.ts`
- `handleYouTubeTranscription()` in `src/services/youtube.service.ts`
- `processTranscriptionWithAI()` in `src/services/transcription.service.ts`
- `openModuleSettings()` in popup components
- `saveModuleSettings()` in settings service
- `getYouTubeCaptions()` in YouTube content script
- `injectYouTubeSidebar()` in YouTube injector

### Existing Functions to Modify
- `handleCurrencyConversionRequest()` - Add better error handling and context menu support
- `initializeContextMenu()` - Support multiple context menu items
- `setupRuntimeMessageListener()` - Add YouTube message handlers

## Classes

### New Classes to Create
- `YouTubeTranscriptionManager` in `src/services/youtube.service.ts`
- `ModuleSettingsManager` in `src/services/settings.service.ts`
- `AIServiceManager` in `src/services/ai.service.ts`

### Existing Classes to Modify
- `CurrencyConverter` component - Add settings integration and context menu features
- `PopupApp` - Convert to module-based architecture

## Dependencies

### New Dependencies to Add
- `@types/youtube` - TypeScript definitions for YouTube API
- `youtube-transcript` - Library for extracting YouTube transcripts
- `@anthropic-ai/sdk` - Claude AI integration
- `openai` - OpenAI API integration

### Existing Dependencies to Update
- `@mui/material` - Update to latest version for better settings UI
- `react` and `react-dom` - Ensure compatibility with new features

## Testing

### New Test Files to Create
- `src/components/YouTube/YouTubeModule.test.tsx`
- `src/services/youtube.service.test.ts`
- `src/components/Settings/SettingsPage.test.tsx`
- `src/background/features/youtube.test.ts`

### Existing Test Files to Update
- `src/components/CurrencyConverter/CurrencyConverter.test.tsx` - Add context menu tests
- `src/background/listeners.test.ts` - Add YouTube listener tests

### Test Strategy
- Unit tests for all new services and components
- Integration tests for YouTube transcription workflow
- E2E tests for currency converter context menu functionality
- Mock implementations for AI services and YouTube API

## Implementation Order

1. **Git Merge Resolution** - Resolve conflicts and merge remote changes
2. **Project Structure Setup** - Create new directories and base files
3. **Core Services** - Implement settings and AI service managers
4. **YouTube Integration** - Migrate YouTube plugin functionality
5. **Currency Converter Enhancement** - Add context menu and settings
6. **Popup Restructuring** - Implement new modular popup structure
7. **Settings Pages** - Create settings for each module
8. **Testing** - Add comprehensive test coverage
9. **Final Integration** - Connect all modules and test end-to-end
10. **Documentation** - Update README and create usage guides
